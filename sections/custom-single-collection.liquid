<link rel="stylesheet" href="{{ 'custom-single-collection.css' | asset_url }}">


<section id="single-collection">
    <div class="single-collection-wrapper">
        <div class="custom-container">
            {%- assign col = section.settings.collection -%}
            <div class="collection-wrap">
                <div class="firstSection" style="background-image: url({{section.settings.bg-image |  img_url: 'master'}});">
                    <div class="content-section">
                        <div class="collec tion-title">
                            <h2>{{col.title}}</h2>
                        </div>
                        <div class="colleciton-description">
                            <p>{{col.description}}</p>
                        </div>
                        <a href="{{section.settings.promos}}">See the Promos</a>
                    </div>
                </div>
                <div class="sliderSection">
                    {%- for product in section.settings.collection.products -%}
                        {% render 'custom-products-slider' with product as product %}
                    {%- endfor -%}
                </div>                
            </div>
        </div>
    </div>
</section>

<script>
    $(document).ready(function () {
        var $slider = $('.sliderSection');

         $slider.slick({
            dots: false,
            infinite: true,
            speed: 300,
            slidesToShow: 3,
            slidesToScroll: 1,
            autoplay: false,
            autoplaySpeed: 6000,
            pauseOnHover: false,
            prevArrow: $('.slick-prev'),
            nextArrow: $('.slick-next'),
            responsive: [
                {
                breakpoint: 1024,
                    settings: {
                        slidesToShow: 2,
                        slidesToScroll: 1,
                    }
                },
                {
                breakpoint: 600,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                }
            ]
        });

        function checkArrows(slider, currentSlide) {
            var totalSlides = slider.slick('getSlick').slideCount;
            var slidesToShow = slider.slick('slickGetOption', 'slidesToShow');

            if (currentSlide === 0) {
                // Hide left arrow if on the first slide
                $('.slick-prev').hide();
            } else {
                // Show left arrow if not on the first slide
                $('.slick-prev').show();
            }

            if (currentSlide >= totalSlides - slidesToShow) {
                // Hide right arrow if on the last slide
                $('.slick-next').hide();
            } else {
                // Show right arrow if not on the last slide
                $('.slick-next').show();
            }
        }

        // Initial check on page load
        checkArrows($slider, 0);

        // Update arrows on slide change
        $slider.on('afterChange', function (event, slick, currentSlide) {
            checkArrows($slider, currentSlide);
        });
    })
    function addToCart(variantId) {
        const data = {
            items: [{
                id: variantId,
                quantity: 1
            }]
        };

        fetch('/cart/add.js', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => response.json())
            .then(data => {
                console.log('Success:', data);
                // document.querySelector('.cart-notification').style.display = 'block';
                // setTimeout(() => {
                //     // document.querySelector('.cart-notification').style.display = 'none';
                // }, 2000);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    }
</script>

{% schema %}
  {
    "name": "Custom Single Collection",
    "settings": [
      {
        "type": "collection",
        "id": "collection",
        "label": "Select Collection"
      },
      {
        "type": "image_picker",
        "id": "bg-image",
        "label": "Background Image"
      },
      {
        "type": "url",
        "id": "promos",
        "label": "Promos URL"
      }
    ],
    "presets": [
      {
        "name": "Custom Single Collection",
        "settings": {
        }
      }
    ]
  }
{% endschema %}